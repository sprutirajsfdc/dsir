<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>58.0</apiVersion>
    <assignments>
        <name>Update_3rd_Party_Agency</name>
        <label>Update 3rd Party Agency</label>
        <locationX>573</locationX>
        <locationY>1259</locationY>
        <assignmentItems>
            <assignToReference>$Record.X3rd_Party_Agency__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.pba__Contact__r.AccountId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Project_filling_inquiry_Community_and_sub_community</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_Price_Max</name>
        <label>Update Price Max</label>
        <locationX>594</locationX>
        <locationY>1901</locationY>
        <assignmentItems>
            <assignToReference>$Record.pba__ListingPrice_pb_max__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Unit__r.CD_Sales_Price__c</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Updating_Agent_Fields</name>
        <label>Updating Agent Fields</label>
        <locationX>573</locationX>
        <locationY>959</locationY>
        <assignmentItems>
            <assignToReference>$Record.B2B_Buyers_Agent__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Getting_Agent.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.B2B_Buyers_Agent_Mobile__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.B2B_Agent__r.MobilePhone</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.B2B_Buyers_Agent_Email__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.B2B_Agent__r.Email</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>When_Inquiry_Type_Agency</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Updating_B2B_Buyer_Fields</name>
        <label>Updating B2B Buyer Fields</label>
        <locationX>573</locationX>
        <locationY>551</locationY>
        <assignmentItems>
            <assignToReference>$Record.B2B_Buyers_Full_Name__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Getting_Client.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.B2B_Buyers_Nationality__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.X3rd_Party_Agency_Client__r.Nationality__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.B2B_Buyers_Gender__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.X3rd_Party_Agency_Client__r.Gender__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.B2B_Buyers_Mobile__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.X3rd_Party_Agency_Client__r.MobilePhone</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.B2B_Buyers_Email__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.X3rd_Party_Agency_Client__r.Email</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>B2B_Agent</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Updating_Communityand_Sub_Community</name>
        <label>Updating Communityand Sub-Community</label>
        <locationX>573</locationX>
        <locationY>1559</locationY>
        <assignmentItems>
            <assignToReference>$Record.pba_uaefields__Community_Propertyfinder__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Project__r.Community__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.pba_uaefields__Sub_Community_Propertyfinder__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Project__r.Sub_Community__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Unit_is_not_empty</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>B2B_Agent</name>
        <label>B2B Agent</label>
        <locationX>705</locationX>
        <locationY>743</locationY>
        <defaultConnector>
            <targetReference>When_Inquiry_Type_Agency</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>B2B_Agent_not_null</name>
            <conditionLogic>((1 AND 2 AND (4 OR 5 OR 6)) OR (1 AND 3 AND (4 OR 5 OR 6)))</conditionLogic>
            <conditions>
                <leftValueReference>$Record.B2B_Agent__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.B2B_Agent__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Is_New_Formula</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.B2B_Buyers_Agent__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.B2B_Buyers_Agent_Mobile__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.B2B_Buyers_Agent_Email__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Getting_Agent</targetReference>
            </connector>
            <label>B2B Agent not null</label>
        </rules>
    </decisions>
    <decisions>
        <name>B2B_buyers</name>
        <label>B2B buyers</label>
        <locationX>705</locationX>
        <locationY>335</locationY>
        <defaultConnector>
            <targetReference>B2B_Agent</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>B2b_Buyers_not_null</name>
            <conditionLogic>((1 AND 2 AND (4 OR 5 OR 6 OR 7) ) OR (1 AND 3 AND (4 OR 5 OR 6 OR 7)))</conditionLogic>
            <conditions>
                <leftValueReference>$Record.X3rd_Party_Agency_Client__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.X3rd_Party_Agency_Client__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Is_New_Formula</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.B2B_Buyers_Full_Name__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.B2B_Buyers_Nationality__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.B2B_Buyers_Mobile__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.B2B_Buyers_Email__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Getting_Client</targetReference>
            </connector>
            <label>B2b Buyers not null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Project_filling_inquiry_Community_and_sub_community</name>
        <label>Project filling inquiry Community and sub community</label>
        <locationX>705</locationX>
        <locationY>1451</locationY>
        <defaultConnector>
            <targetReference>Unit_is_not_empty</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Project_is_not_null</name>
            <conditionLogic>((1 AND 2 AND 3 AND 4) OR (1 AND 5 AND 3 AND 4)) AND 6</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Project__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Project__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.pba_uaefields__Community_Propertyfinder__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.pba_uaefields__Sub_Community_Propertyfinder__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Is_New_Formula</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordTypeId</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>0127T000000Gr2oQAC</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Updating_Communityand_Sub_Community</targetReference>
            </connector>
            <label>Project is not null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Unit_is_not_empty</name>
        <label>Unit is not empty</label>
        <locationX>708</locationX>
        <locationY>1721</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Is_Unit_not_blank</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Is_New_Formula</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Unit__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Price_Max</targetReference>
            </connector>
            <label>Is Unit not blank?</label>
        </rules>
    </decisions>
    <decisions>
        <name>When_Inquiry_Type_Agency</name>
        <label>When Inquiry Type Agency</label>
        <locationX>705</locationX>
        <locationY>1151</locationY>
        <defaultConnector>
            <targetReference>Project_filling_inquiry_Community_and_sub_community</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Inquiry_Type_Agency</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.InquiryType__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Agency</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.pba__Contact__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.X3rd_Party_Agency__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Is_New_Formula</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_3rd_Party_Agency</targetReference>
            </connector>
            <label>Inquiry Type Agency</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>Is_New_Formula</name>
        <dataType>Boolean</dataType>
        <expression>ISNEW()</expression>
    </formulas>
    <interviewLabel>Before Flow - Inquiry B2B Buyers and Agent {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Inquiry Before Flow -  B2B Buyers and Agent</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Getting_Agent</name>
        <label>Getting Agent</label>
        <locationX>573</locationX>
        <locationY>851</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Updating_Agent_Fields</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.B2B_Agent__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Getting_Client</name>
        <label>Getting Client</label>
        <locationX>573</locationX>
        <locationY>443</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Updating_B2B_Buyer_Fields</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.X3rd_Party_Agency_Client__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>579</locationX>
        <locationY>48</locationY>
        <connector>
            <targetReference>B2B_buyers</targetReference>
        </connector>
        <object>pba__Request__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordBeforeSave</triggerType>
    </start>
    <status>Active</status>
</Flow>
